<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YouTube Video Search with Show More</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #result { margin-top: 20px; display: flex; flex-direction: column; gap: 20px; }
    .video-card { border: 1px solid #ccc; padding: 10px; border-radius: 10px; }
    iframe { width: 100%; max-width: 560px; height: 315px; }
    a { text-decoration: none; color: #1a0dab; font-weight: bold; }
    #showMoreBtn { margin-top: 20px; padding: 10px 20px; font-size: 16px; display: none; }
  </style>
</head>
<body>
  <h2>YouTube Video Search</h2>
  <input type="text" id="searchInput" placeholder="Search for a video..." />
  <button onclick="startSearch()">Search</button>

  <div id="result"></div>
  <button id="showMoreBtn" onclick="loadMore()">Show More</button>

  <script>
    const apiKey = "AIzaSyCjAxSw3sw21SYl_ASmnjeOsTq9ooRluZQ";
    let nextPageToken = '';
    let currentQuery = '';

    function startSearch() {
      const query = document.getElementById("searchInput").value.trim();
      if (!query) return alert("Please enter a search term");
      
      currentQuery = query;
      nextPageToken = ''; // reset token
      document.getElementById("result").innerHTML = "Loading...";
      searchVideo(query, true);
    }

    function loadMore() {
      searchVideo(currentQuery, false);
    }

    function searchVideo(query, isNewSearch = false) {
      const url = new URL('https://www.googleapis.com/youtube/v3/search');
      url.searchParams.set('part', 'snippet');
      url.searchParams.set('type', 'video');
      url.searchParams.set('maxResults', '5');
      url.searchParams.set('q', query);
      url.searchParams.set('key', apiKey);
      if (nextPageToken) url.searchParams.set('pageToken', nextPageToken);

      fetch(url.toString())
        .then(res => res.json())
        .then(data => {
          const results = data.items;
          nextPageToken = data.nextPageToken || '';
          const showMoreBtn = document.getElementById("showMoreBtn");

          if (results.length) {
            let html = '';
            results.forEach(video => {
              const videoId = video.id.videoId;
              const title = video.snippet.title;
              const description = video.snippet.description;
              const url = `https://www.youtube.com/watch?v=${videoId}`;

              html += `
                <div class="video-card">
                  <a href="${url}" target="_blank">${title}</a>
                  <iframe src="https://www.youtube.com/embed/${videoId}" allowfullscreen></iframe>
                  <p>${description}</p>
                </div>
              `;
            });

            if (isNewSearch) {
              document.getElementById("result").innerHTML = html;
            } else {
              document.getElementById("result").insertAdjacentHTML('beforeend', html);
            }

            showMoreBtn.style.display = nextPageToken ? 'inline-block' : 'none';
          } else {
            document.getElementById("result").innerHTML = "No results found.";
            showMoreBtn.style.display = 'none';
          }
        })
        .catch(err => {
          console.error("Error:", err);
          document.getElementById("result").innerHTML = "Error fetching video.";
        });
    }
  </script>
</body>
</html>
